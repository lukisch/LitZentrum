<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>LitZentrum – Roadmap, Architektur, API & Upgrade-Konzept</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      line-height: 1.5;
      margin: 2rem;
      background: #f7f7f9;
      color: #222;
    }
    h1, h2, h3, h4 {
      color: #1b365d;
      margin-top: 2rem;
    }
    h1 {
      border-bottom: 3px solid #1b365d;
      padding-bottom: 0.3rem;
    }
    section {
      background: #ffffff;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.08);
    }
    code {
      background: #f0f0f4;
      padding: 0.1rem 0.25rem;
      border-radius: 4px;
      font-size: 0.95em;
    }
    pre {
      background: #111827;
      color: #e5e7eb;
      padding: 1rem;
      border-radius: 6px;
      overflow-x: auto;
      font-size: 0.9em;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin: 0.5rem 0 1rem 0;
      font-size: 0.9em;
    }
    th, td {
      padding: 0.4rem 0.6rem;
      border: 1px solid #d1d5db;
      vertical-align: top;
    }
    th {
      background: #e5e7eb;
      text-align: left;
    }
    .gantt-table th {
      text-align: center;
      font-size: 0.85em;
    }
    .gantt-bar {
      height: 1.1rem;
      border-radius: 999px;
      background: linear-gradient(90deg, #2563eb, #38bdf8);
    }
    .gantt-bar-later {
      background: linear-gradient(90deg, #7c3aed, #ec4899);
    }
    .badge {
      display: inline-block;
      padding: 0.1rem 0.4rem;
      border-radius: 999px;
      font-size: 0.75em;
      background: #e5e7eb;
      color: #111827;
      margin-right: 0.25rem;
    }
    .badge-core {
      background: #dbeafe;
      color: #1d4ed8;
    }
    .badge-gui {
      background: #dcfce7;
      color: #166534;
    }
    .badge-api {
      background: #fef3c7;
      color: #92400e;
    }
    .badge-ext {
      background: #fce7f3;
      color: #9d174d;
    }
    .subtle {
      font-size: 0.85em;
      color: #6b7280;
    }
    ul {
      margin-top: 0.25rem;
      margin-bottom: 0.75rem;
    }
    li {
      margin-bottom: 0.25rem;
    }
    .arch-box {
      font-family: "JetBrains Mono", "Fira Code", Consolas, monospace;
      font-size: 0.8em;
      white-space: pre;
      background: #0f172a;
      color: #e5e7eb;
      padding: 1rem;
      border-radius: 8px;
      overflow-x: auto;
    }
    .muted {
      color: #6b7280;
      font-size: 0.85em;
    }
  </style>
</head>
<body>

  <h1>LitZentrum – Roadmap, Architektur, API-Spezifikation & Upgrade-Konzept</h1>
  <p class="subtle">
    Basis: MVP LitZentrum (Stand 03.01.2026) mit Core, JSON-Formaten, GUI, PDF-Werkstatt, Bibliografie, KI-Queue (Grundstruktur) und Sync.
  </p>

  <!-- ========================================================= -->
  <!-- 1. GANTT-PLANUNG                                         -->
  <!-- ========================================================= -->

  <section id="gantt-plan">
    <h2>1. Gantt-Planung für zukünftige LitZentrum-Versionen</h2>
    <p>
      Planungshorizont: ca. 12–18 Monate nach aktuellem MVP.  
      Zeitskala: Quartalsweise, mit Fokus auf modularen Ausbau rund um Word/LaTeX, Metadaten, Browser, Stile und Query-Engine.
    </p>

    <h3>1.1 Zeitachse und Versionen</h3>
    <table class="gantt-table">
      <thead>
        <tr>
          <th style="width:18%">Version</th>
          <th style="width:32%">Ziel</th>
          <th>Q1</th>
          <th>Q2</th>
          <th>Q3</th>
          <th>Q4</th>
          <th>Q5</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><strong>v1.1 – Dokument-Integration</strong></td>
          <td>
            Word-/LaTeX-Export-Pipeline, stabile Zitations-Engine<br />
            <span class="badge badge-core">Core</span>
            <span class="badge badge-gui">GUI</span>
            <span class="badge badge-ext">Office/LaTeX</span>
          </td>
          <td><div class="gantt-bar"></div></td>
          <td><div class="gantt-bar"></div></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>

        <tr>
          <td><strong>v1.2 – Metadaten-Automation</strong></td>
          <td>
            DOI/ISBN-Lookup, Enrichment-Pipeline, Validator<br />
            <span class="badge badge-core">Core</span>
            <span class="badge badge-api">API</span>
          </td>
          <td></td>
          <td><div class="gantt-bar"></div></td>
          <td><div class="gantt-bar"></div></td>
          <td></td>
          <td></td>
        </tr>

        <tr>
          <td><strong>v1.3 – Browser & Web-Importer</strong></td>
          <td>
            Browser-Extension, lokales Import-API, Site-Scraper<br />
            <span class="badge badge-ext">Browser</span>
            <span class="badge badge-api">API</span>
          </td>
          <td></td>
          <td></td>
          <td><div class="gantt-bar"></div></td>
          <td><div class="gantt-bar"></div></td>
          <td></td>
        </tr>

        <tr>
          <td><strong>v1.4 – Zitationsstile & CSL</strong></td>
          <td>
            CSL-Engine, Style-Repository, Journal-Stile<br />
            <span class="badge badge-core">Core</span>
            <span class="badge badge-gui">GUI</span>
          </td>
          <td></td>
          <td></td>
          <td><div class="gantt-bar-later"></div></td>
          <td><div class="gantt-bar-later"></div></td>
          <td></td>
        </tr>

        <tr>
          <td><strong>v1.5 – Query Engine & Wissens-Hub</strong></td>
          <td>
            Query-Engine, ProFiler-Query, Tabellenexport<br />
            <span class="badge badge-core">Core</span>
            <span class="badge-api">API</span>
          </td>
          <td></td>
          <td></td>
          <td></td>
          <td><div class="gantt-bar-later"></div></td>
          <td><div class="gantt-bar-later"></div></td>
        </tr>

        <tr>
          <td><strong>v2.0 – KI-Forschungsassistent</strong></td>
          <td>
            KI-Zitationsvorschläge, KI-Harmonisierung, Literatur-Discovery<br />
            <span class="badge badge-core">Core</span>
            <span class="badge badge-api">AI</span>
          </td>
          <td></td>
          <td></td>
          <td></td>
          <td><div class="gantt-bar-later"></div></td>
          <td><div class="gantt-bar-later"></div></td>
        </tr>
      </tbody>
    </table>

    <h3>1.2 Meilensteine</h3>
    <ul>
      <li><strong>M1 (Ende Q1):</strong> Bib-Export stabil, Word/LaTeX-Basispipeline, erster Word-Add-In-Prototyp.</li>
      <li><strong>M2 (Mitte Q2):</strong> DOI/ISBN-Lookup mit automatischem Enrichment, Meta-Validator produktiv.</li>
      <li><strong>M3 (Ende Q3):</strong> Browser-Extension mit Import in laufendes Projekt, Basis-Unterstützung für große Verlage.</li>
      <li><strong>M4 (Ende Q4):</strong> CSL-Integration, Style-Store, pro Projekt wählbare Journals.</li>
      <li><strong>M5 (Q5):</strong> Query-Engine über alle Projekte, Export nach CSV/Markdown, Vorbereitung für KI-gestützte Queries.</li>
    </ul>
  </section>

  <!-- ========================================================= -->
  <!-- 2. ARCHITEKTUR-SKIZZE                                    -->
  <!-- ========================================================= -->

  <section id="architektur">
    <h2>2. Architektur-Skizze für spätere LitZentrum-Versionen</h2>

    <p>
      Die aktuelle LitZentrum-Architektur (Core, GUI, Modules, Data-Layer) bleibt erhalten.  
      Die neuen Funktionen werden als klar abgegrenzte Module und Integrationsschichten ergänzt.
    </p>

    <h3>2.1 High-Level-Layering (erweitertes Architekturdiagramm)</h3>

    <div class="arch-box">
┌──────────────────────────────────────────────────────────────────────────────┐
│                              LitZentrum 2.x                                 │
├──────────────────────────────────────────────────────────────────────────────┤
│                               GUI LAYER                                     │
│  ┌────────────────────────────────────────────────────────────────────────┐  │
│  │ MainWindow / Panels / Tabs / Dialogs                                  │  │
│  │                                                                        │  │
│  │  • ProjectTreePanel     • SourceListPanel    • DetailPanel             │  │
│  │  • PDFTab               • Notes/Quotes/Tasks/Summaries Tabs           │  │
│  │  • BibliographyDialog   • Word/LaTeX Export Dialog                     │  │
│  │  • Search/QueryDialog   • AIQueueDialog                                │  │
│  └────────────────────────────────────────────────────────────────────────┘  │
│                                      │                                       │
├──────────────────────────────────────┴───────────────────────────────────────┤
│                               CORE LAYER                                    │
│  ┌────────────────────────────────────────────────────────────────────────┐  │
│  │ ProjectManager   SourceManager   FormatHandler (.li*)                  │  │
│  │ EventBus         SettingsManager ProfilerBridge                        │  │
│  │                                                                        │  │
│  │ NEW:                                                                   │  │
│  │  • CitationEngine      (Bib/CSL, Styles)                               │  │
│  │  • ExportManager       (Word/LaTeX/BibLaTeX)                           │  │
│  │  • MetadataEnrichment  (DOI/ISBN Queue)                                │  │
│  │  • QueryEngine         (Projekt-/Quellen-Abfragen)                     │  │
│  └────────────────────────────────────────────────────────────────────────┘  │
│                                      │                                       │
├──────────────────────────────────────┴───────────────────────────────────────┤
│                              MODULE LAYER                                   │
│  ┌────────────────────────────────────────────────────────────────────────┐  │
│  │  PDF_WORKSHOP   BIBLIOGRAPHY   AI-MODULE   SYNC-MODULE   INTEGRATION   │  │
│  │                                                                        │  │
│  │  • pdf_workshop/   • bibliography/   • ai/           • sync/          │  │
│  │                                                                        │  │
│  │  NEW INTEGRATIONS:                                                     │  │
│  │   - office_integration/                                               │  │
│  │       • word_addin_bridge.py                                          │  │
│  │       • citation_field_mapper.py                                      │  │
│  │   - latex_integration/                                                │  │
│  │       • bib_exporter.py                                               │  │
│  │       • latex_project_helper.py                                       │  │
│  │   - web_import/                                                       │  │
│  │       • browser_api_gateway.py                                        │  │
│  │       • site_scrapers/ (jstor, springer, ieee, arxiv, …)              │  │
│  └────────────────────────────────────────────────────────────────────────┘  │
│                                      │                                       │
├──────────────────────────────────────┴───────────────────────────────────────┤
│                               INTEGRATION LAYER                             │
│  ┌────────────────────────────────────────────────────────────────────────┐  │
│  │  Local HTTP API (LitZentrum Service)                                  │  │
│  │                                                                        │  │
│  │  • /api/project                                                        │  │
│  │  • /api/source                                                         │  │
│  │  • /api/import                                                         │  │
│  │  • /api/citation                                                       │  │
│  │  • /api/metadata                                                       │  │
│  │  • /api/query                                                          │  │
│  └────────────────────────────────────────────────────────────────────────┘  │
│                                      │                                       │
├──────────────────────────────────────┴───────────────────────────────────────┤
│                               DATA LAYER                                    │
│  ┌────────────────────────────────────────────────────────────────────────┐  │
│  │  • Projekt-Ordnerstruktur                                             │  │
│  │     - Quellen/…/source.pdf                                            │  │
│  │     - meta.limeta, notes.linote, quotes.liquote, …                    │  │
│  │  • Index-Datenbank (SQLite, ProFiler)                                 │  │
│  │  • Backup/Sync-Repositories (Git, Cloud-Speicher)                     │  │
│  └────────────────────────────────────────────────────────────────────────┘  │
└──────────────────────────────────────────────────────────────────────────────┘
    </div>

    <h3>2.2 Rollen der neuen Komponenten</h3>
    <ul>
      <li><strong>CitationEngine:</strong> zentrale Schicht für Formatierung von Zitationen (In-Text, Fußnoten, Bibliografie) mit BibTeX/CSL-Unterstützung.</li>
      <li><strong>ExportManager:</strong> orchestriert Word-, LaTeX-, BibTeX- und BibLaTeX-Exporte, inkl. Stil-Auswahl.</li>
      <li><strong>MetadataEnrichment:</strong> Hintergrund-Jobs, die DOIs/ISBNs auflösen und <code>.limeta</code> anreichern.</li>
      <li><strong>QueryEngine:</strong> einheitliche Abfrageschicht für projektweite Suchen (Meta + Volltext).</li>
      <li><strong>office_integration:</strong> Brücke zum Word-Add-in (OfficeJS) über lokale HTTP-API.</li>
      <li><strong>latex_integration:</strong> Export von <code>.bib</code> und Projekt-Hilfsdateien (z.B. LaTeX-Snippets für \printbibliography).</li>
      <li><strong>web_import:</strong> HTTP-Gateway für Browser-Extension + Spezialisierte Scraper pro Plattform.</li>
    </ul>
  </section>

  <!-- ========================================================= -->
  <!-- 3. API-SPEZIFIKATION                                     -->
  <!-- ========================================================= -->

  <section id="api-spec">
    <h2>3. API-Spezifikation (lokale HTTP-API für Browser & Word/LaTeX)</h2>

    <p>
      Die API ist als <strong>lokaler HTTP-Service</strong> konzipiert (z.B. <code>http://localhost:5123</code>), 
      der von Browser-Erweiterung, Word-Add-in und ggf. LaTeX-Helfern genutzt wird.  
      Authentifizierung kann anfangs über einfachen Token in Config erfolgen.
    </p>

    <h3>3.1 Basisangaben</h3>
    <ul>
      <li><strong>Base URL:</strong> <code>http://127.0.0.1:5123</code></li>
      <li><strong>Format:</strong> JSON (UTF-8)</li>
      <li><strong>Versionierung:</strong> <code>/api/v1/...</code></li>
      <li><strong>Auth (optional später):</strong> Header <code>X-Lit-Token: &lt;secret&gt;</code></li>
    </ul>

    <h3>3.2 Endpunkte – Projekt & Quellen</h3>

    <h4>GET /api/v1/projects</h4>
    <ul>
      <li><strong>Beschreibung:</strong> Liste aller bekannten Projekte.</li>
      <li><strong>Antwort (200):</strong></li>
    </ul>
    <pre>{
  "projects": [
    {
      "id": "proj_01",
      "name": "Masterarbeit KI",
      "path": "D:/Lit/Masterarbeit_KI",
      "default_citation_style": "apa"
    }
  ]
}</pre>

    <h4>GET /api/v1/project/current</h4>
    <ul>
      <li><strong>Beschreibung:</strong> Liefert das aktuell geöffnete Projekt.</li>
      <li><strong>Antwort (200):</strong> wie einzelner Eintrag aus <code>/projects</code>.</li>
    </ul>

    <h4>GET /api/v1/project/{projectId}/sources</h4>
    <ul>
      <li><strong>Beschreibung:</strong> Liste aller Quellen eines Projekts.</li>
      <li><strong>Antwort (200):</strong></li>
    </ul>
    <pre>{
  "sources": [
    {
      "id": "src_Smith2023_AI_Study",
      "folder_name": "Smith2023_AI_Study",
      "title": "Understanding AI",
      "authors": ["Smith, John"],
      "year": 2023,
      "tags": ["AI", "Methodik"],
      "status": "in_progress"
    }
  ]
}</pre>

    <h3>3.3 Endpunkte – Import (Browser-Extension)</h3>

    <h4>POST /api/v1/import/pdf</h4>
    <ul>
      <li><strong>Beschreibung:</strong> Importiert eine PDF-Datei als neue Quelle in das aktuelle Projekt.</li>
      <li><strong>Request (multipart/form-data):</strong></li>
    </ul>
    <pre>
field "project_id": "proj_01"
field "file": &lt;PDF Datei&gt;
field "suggested_title": "Understanding AI"
field "url": "https://publisher.com/article/123"
field "metadata": { ... JSON als Text ... }
    </pre>
    <ul>
      <li><strong>Antwort (201):</strong></li>
    </ul>
    <pre>{
  "status": "ok",
  "source": {
    "id": "src_Smith2023_AI_Study",
    "folder_name": "Smith2023_AI_Study"
  }
}</pre>

    <h4>POST /api/v1/import/metadata</h4>
    <ul>
      <li><strong>Beschreibung:</strong> Nur Metadaten ohne Datei importieren (z.B. für Web-Artikel ohne PDF).</li>
      <li><strong>Request (JSON):</strong></li>
    </ul>
    <pre>{
  "project_id": "proj_01",
  "title": "Understanding AI",
  "authors": ["Smith, John"],
  "year": 2023,
  "doi": "10.1234/ai.2023.001",
  "url": "https://publisher.com/article/123",
  "tags": ["AI", "Methodik"]
}</pre>

    <h3>3.4 Endpunkte – Zitationen & Bibliografie (Word/LaTeX)</h3>

    <h4>GET /api/v1/citation/styles</h4>
    <ul>
      <li><strong>Beschreibung:</strong> Liste aller verfügbaren Stile.</li>
      <li><strong>Antwort (200):</strong></li>
    </ul>
    <pre>{
  "styles": [
    { "id": "apa", "name": "APA 7th" },
    { "id": "mla", "name": "MLA 9th" },
    { "id": "din", "name": "DIN 1505" }
  ]
}</pre>

    <h4>POST /api/v1/citation/inline</h4>
    <ul>
      <li><strong>Beschreibung:</strong> Liefert formatierte In-Text-Zitation für eine Quelle.</li>
      <li><strong>Request (JSON):</strong></li>
    </ul>
    <pre>{
  "project_id": "proj_01",
  "source_id": "src_Smith2023_AI_Study",
  "page": 42,
  "style": "apa"
}</pre>
    <ul>
      <li><strong>Antwort (200):</strong></li>
    </ul>
    <pre>{
  "citation": "(Smith, 2023, S. 42)"
}</pre>

    <h4>POST /api/v1/citation/bibliography</h4>
    <ul>
      <li><strong>Beschreibung:</strong> Generiert ein komplettes Literaturverzeichnis.</li>
      <li><strong>Request (JSON):</strong></li>
    </ul>
    <pre>{
  "project_id": "proj_01",
  "style": "apa",
  "source_ids": ["src_Smith2023_AI_Study", "src_Mueller2022_Methodik"]
}</pre>
    <ul>
      <li><strong>Antwort (200):</strong></li>
    </ul>
    <pre>{
  "entries": [
    "Smith, J. (2023). Understanding AI. Springer.",
    "Müller, A. (2022). Methodik der KI-Forschung. Elsevier."
  ]
}</pre>

    <h3>3.5 Endpunkte – Metadaten & Query</h3>

    <h4>POST /api/v1/metadata/enrich</h4>
    <ul>
      <li><strong>Beschreibung:</strong> Startet Enrichment für eine Quelle (DOI/ISBN-Lookup).</li>
      <li><strong>Request (JSON):</strong></li>
    </ul>
    <pre>{
  "project_id": "proj_01",
  "source_id": "src_Smith2023_AI_Study",
  "strategy": "doi_first"
}</pre>

    <h4>POST /api/v1/query</h4>
    <ul>
      <li><strong>Beschreibung:</strong> Führt eine abstrakte Query über Metadaten und (optional) Volltext aus.</li>
      <li><strong>Request (JSON):</strong></li>
    </ul>
    <pre>{
  "project_id": "proj_01",
  "query": {
    "filters": [
      { "field": "year", "op": "&gt;=", "value": 2020 },
      { "field": "tags", "op": "contains", "value": "AI" }
    ],
    "fulltext": "explainable AND robust",
    "limit": 50,
    "sort": { "field": "year", "direction": "desc" }
  }
}</pre>
    <ul>
      <li><strong>Antwort (200):</strong> Trefferliste mit Basis-Metadaten.</li>
    </ul>
  </section>

  <!-- ========================================================= -->
  <!-- 4. UPGRADE-KONZEPT                                       -->
  <!-- ========================================================= -->

  <section id="upgrade-konzept">
    <h2>4. Upgrade-Konzept für spätere LitZentrum-Versionen</h2>

    <p>
      Das Upgrade-Konzept stellt sicher, dass bestehende Projekte (<code>.liproj</code>, <code>.limeta</code>, <code>.linote</code> etc.) 
      auch in zukünftigen Versionen stabil weiterlaufen, während neue Features schrittweise aktiviert werden.
    </p>

    <h3>4.1 Prinzipien</h3>
    <ul>
      <li><strong>Schema-Versionierung:</strong> jedes <code>.li*</code>-Format behält <code>_schema_version</code> im JSON.</li>
      <li><strong>Non-breaking Changes:</strong> neue Felder nur ergänzend; alte Felder nicht umbenennen, sondern mappen.</li>
      <li><strong>Migrationsroutinen:</strong> bei erstem Öffnen in neuer Version werden Projekte still migriert.</li>
      <li><strong>Capability Flags:</strong> Features sind im Projektkonfig (<code>.liproj</code>) als Flags aktivierbar.</li>
    </ul>

    <h3>4.2 Versionierung der Formate</h3>

    <table>
      <thead>
        <tr>
          <th>Format</th>
          <th>Aktuelle Version</th>
          <th>Geplante Erweiterungen</th>
          <th>Kompatibilitätsstrategie</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>meta.limeta</code></td>
          <td>1.0</td>
          <td>journal, issue, pages, citation_key, external_ids</td>
          <td>Neue Felder optional, Default-Werte, Generator für <code>citation_key</code>.</td>
        </tr>
        <tr>
          <td><code>notes.linote</code></td>
          <td>1.0</td>
          <td>note_type (idea, critique, summary), link zu Quotes/Tasks</td>
          <td>Standardtyp "note" für alte Einträge.</td>
        </tr>
        <tr>
          <td><code>quotes.liquote</code></td>
          <td>1.0</td>
          <td>link zu <code>meta.limeta</code> (für Multi-Source-Quotes), citation_style_cache</td>
          <td>Fallback ohne Cache, wird bei Bedarf aufgebaut.</td>
        </tr>
        <tr>
          <td><code>projekt_config.liproj</code></td>
          <td>1.0</td>
          <td>default_citation_style, enabled_features (word, latex, browser, ai)</td>
          <td>Beim Upgrade: Defaults setzen, falls Felder fehlen.</td>
        </tr>
      </tbody>
    </table>

    <h3>4.3 Upgrade-Pfade je Version</h3>

    <h4>Upgrade auf v1.1 (Word/LaTeX)</h4>
    <ul>
      <li><strong>Migration:</strong> <code>projekt_config.liproj</code> → Feld <code>default_citation_style</code> = "apa" falls nicht vorhanden.</li>
      <li><strong>Neues Modul:</strong> <code>modules/bibliography/</code> wird erweitert um CSL/BibLaTeX-Support (ggf. in 1.4 ausgebaut).</li>
      <li><strong>Abwärtskompatibilität:</strong> alte Projekte können weiterhin nur BibTeX exportieren, wenn keine Stile aktiviert sind.</li>
    </ul>

    <h4>Upgrade auf v1.2 (Metadaten-Automation)</h4>
    <ul>
      <li><strong>Migration:</strong> in <code>meta.limeta</code> werden Felder <code>external_ids</code> (dict) ergänzt:
        <code>{"crossref": "...", "openlibrary": "..."}</code>.
      </li>
      <li><strong>Enrichment-Queue:</strong> <code>modules/ai/</code> oder eigenes <code>metadata/</code>-Modul mit Job-Schema.</li>
      <li><strong>Fallback:</strong> wenn keine Internetverbindung → manuelle Metadaten wie bisher.</li>
    </ul>

    <h4>Upgrade auf v1.3 (Browser-Extension)</h4>
    <ul>
      <li><strong>Neues Subsystem:</strong> <code>modules/web_import/</code> + <code>integration/http_service.py</code>.</li>
      <li><strong>Konfig:</strong> in <code>projekt_config.liproj</code> Flag <code>"allow_web_import": true/false</code>.</li>
      <li><strong>Sicherheit:</strong> Option, die lokale API komplett zu deaktivieren.</li>
    </ul>

    <h4>Upgrade auf v1.4 (CSL & Stile)</h4>
    <ul>
      <li><strong>Neue Struktur:</strong> <code>resources/citation_styles/</code> mit heruntergeladenen <code>.csl</code>-Dateien.</li>
      <li><strong>Konfig:</strong> pro Projekt <code>"journal_styles": ["nature.csl", "ieee.csl"]</code>.</li>
      <li><strong>Fallback:</strong> wenn CSL-Engine nicht verfügbar → alte BibTeX-Engine weiter nutzen.</li>
    </ul>

    <h4>Upgrade auf v1.5 & 2.0 (Query & KI)</h4>
    <ul>
      <li><strong>Index:</strong> ProFiler-Datenbank erhält zusätzliche FTS-Felder, bleibt aber optional (Rebuild möglich).</li>
      <li><strong>QueryEngine:</strong> neue API für Queries auf Daten + Volltext, ohne bestehende Strukturen zu verändern.</li>
      <li><strong>KI-Features:</strong> nur aktiv, wenn KI-Module explizit eingeschaltet sind (Flag in Settings).</li>
    </ul>

    <h3>4.4 Upgrade-Mechanismus im Code</h3>

    <p>Empfohlenes Muster in Python (vereinfacht):</p>
    <pre>def migrate_project(project_path: Path):
    config_file = project_path / "projekt_config.liproj"
    data = json.load(open(config_file, "r", encoding="utf-8"))

    version = data.get("_schema_version", "1.0")

    if version == "1.0":
        # Migration auf 1.1
        data.setdefault("default_citation_style", "apa")
        data.setdefault("enabled_features", [])
        version = "1.1"

    if version == "1.1":
        # Migration auf 1.2
        data.setdefault("enabled_features", [])
        version = "1.2"

    # ...

    data["_schema_version"] = version
    json.dump(data, open(config_file, "w", encoding="utf-8"), indent=2, ensure_ascii=False)</pre>

    <p class="muted">
      So bleiben alle bestehenden Projekte funktionsfähig, während neuere Versionen zusätzliche Felder bewusst ergänzen, 
      ohne das Datenmodell zu brechen.
    </p>
  </section>

</body>
</html>